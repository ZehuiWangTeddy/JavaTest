#name: Publish to Google cloud
#on:
#  push:
#    branches: [ "acceptance" ]
#  pull_request:
#    branches: [ "acceptance" ]
#
#jobs:
#  build:
#    runs-on: ubuntu-latest
#
#    steps:
#
#      - name: Checkout code
#        uses: actions/checkout@v3
#
#      - name: Log recent commit
#        run: git log -1
#
#      - name: Set up JDK 17
#        uses: actions/setup-java@v3
#        with:
#            java-version: '17'
#            distribution: 'oracle'
#            cache: maven
#
#      - name: Build with Maven
#        run: mvn clean verify

      #      - name: Zip report directory
      #        run: zip -r jabberpoint.zip target/*.jar

      # Set up Google Cloud SDK
#      - name: Install Google Cloud SDK
#        run: |
#          curl https://sdk.cloud.google.com | bash
#          exec -l $SHELL
#          gcloud init

      # Authenticate with Google Cloud Storage
#      - name: Authenticate with Google Cloud Storage
#        run: gcloud auth activate-service-account --key-file=${{ secrets.GOOGLE_APPLICATION_CREDENTIALS }}


      # Upload file to Google Cloud Storage
#      - name: Upload file to Google Cloud Storage
#        run: gsutil cp target/*.jar gs://japperpoint_accepentance/testFolder/
#      - name: Upload to Google cloud
#        uses: adityak74/google-drive-upload-git-action@main
#        with:
#          credentials: ${{ secrets.GOOGLE_DRIVE_CREDENTIALS }}
#          filename: "target/*.jar"
#          folderId: ${{ secrets.GOOGLE_DRIVE_FOLDER_ID }}
#          name: "Java.jar"
#          overwrite: "true" # optional boolean

name: Publish to Google cloud
on:
  push:
    branches: [ "acceptance" ]
  pull_request:
    branches: [ "acceptance" ]
jobs:
  publish_to_google_cloud:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Upload File to GCS
        uses: google-github-actions/upload-cloud-storage@v2
        with:
          path: 'target/JabberPoint-1.0-SNAPSHOT.jar'
          destination: 'japperpoint_accepentance/testFolder'
          override: true

#      - id: 'auth'
#        uses: 'google-github-actions/auth@v2'
#        with:
#          token: ${{ secrets.GIT_RP_KEY }}
#          workload_identity_provider: 'projects/501528196522/locations/global/workloadIdentityPools/javatest/providers/117754008959506789521'
#          service_account: 'testjava@warm-bonfire-418221.iam.gserviceaccount.com'
#
#      - id: 'upload-file'
#        uses: 'google-github-actions/upload-cloud-storage@v2'
#        with:
#          path: 'target/*.jar'
#          destination: 'japperpoint_accepentance/testFolder'
#          override: true


